import torchvision.models as models
import geffnet
import sys, os
from transformers import AutoModelForQuestionAnswering

pretrained_models = {
    'alexnet': models.alexnet(pretrained = True),
    'convnext_tiny': models.convnext_tiny(pretrained = True),
    'convnext_small': models.convnext_small(pretrained = True),
    'convnext_base': models.convnext_base(pretrained = True),
    'convnext_large': models.convnext_large(pretrained = True),
    'swin_t': models.swin_t(),
    'swin_s': models.swin_s(),
    'swin_b': models.swin_b(),
    # 'vit_b_16': models.vit_b_16(pretrained = True),
    # 'vit_b_32': models.vit_b_32(pretrained = True),
    # 'vit_l_16': models.vit_l_16(pretrained = True),
    # 'vit_l_32': models.vit_l_32(pretrained = True),
    # 'vit_h_14': models.vit_h_14(),
    'vgg11': models.vgg11(pretrained = True),
    'vgg13': models.vgg13(pretrained = True),
    'vgg16': models.vgg16(pretrained = True),
    'vgg19': models.vgg19(pretrained = True),
    'vgg11_bn': models.vgg11_bn(pretrained = True),
    'vgg13_bn': models.vgg13_bn(pretrained = True),
    'vgg16_bn': models.vgg16_bn(pretrained = True),
    'vgg19_bn': models.vgg19_bn(pretrained = True),
    'resnet18': models.resnet18(pretrained = True),
    'resnet34': models.resnet34(pretrained = True),
    'resnet50': models.resnet50(pretrained = True),
    'resnet101': models.resnet101(pretrained = True),
    'resnet152': models.resnet152(pretrained = True),
    'resnext50_32x4d': models.resnext50_32x4d(pretrained = True),
    'resnext101_32x8d': models.resnext101_32x8d(pretrained = True),
    'resnext101_64x4d': models.resnext101_64x4d(),
    'wide_resnet50_2': models.wide_resnet50_2(pretrained = True),
    'wide_resnet101_2': models.wide_resnet101_2(pretrained = True),
    'squeezenet1_0': models.squeezenet1_0(pretrained = True),
    'squeezenet1_1': models.squeezenet1_1(pretrained = True),
    'densenet121': models.densenet121(pretrained = True),
    'densenet169': models.densenet169(pretrained = True),
    'densenet201': models.densenet201(pretrained = True),
    'densenet161': models.densenet161(pretrained = True),
    'inception_v3_google': models.inception_v3(pretrained = True),
    'googlenet': models.googlenet(pretrained = True),
    'shufflenet_v2_x0_5': models.shufflenet_v2_x0_5(pretrained = True),
    'shufflenet_v2_x1_0': models.shufflenet_v2_x1_0(pretrained = True),
    'shufflenet_v2_x1_5': models.shufflenet_v2_x1_5(pretrained = False),
    'shufflenet_v2_x2_0': models.shufflenet_v2_x2_0(pretrained = False),
    'mobilenet_v2': models.mobilenet_v2(pretrained = True),
    'mobilenet_v3_large': models.mobilenet_v3_large(pretrained = True),
    'mobilenet_v3_small': models.mobilenet_v3_small(pretrained = True),
    'mnasnet0_5': models.mnasnet0_5(pretrained = True),
    'mnasnet0_75': models.mnasnet0_75(pretrained = False),
    'mnasnet1_0': models.mnasnet1_0(pretrained = True),
    'mnasnet1_3': models.mnasnet1_3(pretrained = False),
    'efficientnet_b0': models.efficientnet_b0(pretrained = True),
    'efficientnet_b1': models.efficientnet_b1(pretrained = True),
    'efficientnet_b2': models.efficientnet_b2(pretrained = True),
    'efficientnet_b3': models.efficientnet_b3(pretrained = True),
    'efficientnet_b4': models.efficientnet_b4(pretrained = True),
    'efficientnet_b5': models.efficientnet_b5(pretrained = True),
    'efficientnet_b6': models.efficientnet_b6(pretrained = True),
    'efficientnet_b7': models.efficientnet_b7(pretrained = True),
    'efficientnet_v2_s': models.efficientnet_v2_s(pretrained = True),
    'efficientnet_v2_m': models.efficientnet_v2_m(pretrained = True),
    'efficientnet_v2_l': models.efficientnet_v2_l(pretrained = True),
    'regnet_y_400mf': models.regnet_y_400mf(pretrained = True),
    'regnet_y_800mf': models.regnet_y_800mf(pretrained = True),
    'regnet_y_1_6gf': models.regnet_y_1_6gf(pretrained = True),
    'regnet_y_3_2gf': models.regnet_y_3_2gf(pretrained = True),
    'regnet_y_8gf': models.regnet_y_8gf(pretrained = True),
    'regnet_y_16gf': models.regnet_y_16gf(pretrained = True),
    'regnet_y_32gf': models.regnet_y_32gf(pretrained = True),
    'regnet_y_128gf': models.regnet_y_128gf(),
    'regnet_x_400mf': models.regnet_x_400mf(pretrained = True),
    'regnet_x_800mf': models.regnet_x_800mf(pretrained = True),
    'regnet_x_1_6gf': models.regnet_x_1_6gf(pretrained = True),
    'regnet_x_3_2gf': models.regnet_x_3_2gf(pretrained = True),
    'regnet_x_8gf': models.regnet_x_8gf(pretrained = True),
    'regnet_x_16gf': models.regnet_x_16gf(pretrained = True),
    'regnet_x_32gf': models.regnet_x_32gf(pretrained = True),
    # 'fcn_resnet50': models.segmentation.fcn_resnet50(pretrained = True),
    # 'fcn_resnet101': models.segmentation.fcn_resnet101(pretrained = True),
    # 'deeplabv3_resnet50': models.segmentation.deeplabv3_resnet50(pretrained = True),
    # 'deeplabv3_resnet101': models.segmentation.deeplabv3_resnet101(pretrained = True),
    # 'deeplabv3_mobilenet_v3_large': models.segmentation.deeplabv3_mobilenet_v3_large(pretrained = True),
    # 'lraspp_mobilenet_v3_large': models.segmentation.lraspp_mobilenet_v3_large(pretrained = True),
    # 'fasterrcnn_resnet50_fpn': models.detection.fasterrcnn_resnet50_fpn(pretrained=True),
    # 'fasterrcnn_resnet50_fpn_v2': models.detection.fasterrcnn_resnet50_fpn_v2(pretrained=True),
    # 'fasterrcnn_mobilenet_v3_large_fpn': models.detection.fasterrcnn_mobilenet_v3_large_fpn(pretrained=True),
    # 'fasterrcnn_mobilenet_v3_large_320_fpn': models.detection.fasterrcnn_mobilenet_v3_large_320_fpn(pretrained=True),
    # 'fcos_resnet50_fpn': models.detection.fcos_resnet50_fpn(pretrained=True),
    # 'maskrcnn_resnet50_fpn': models.detection.maskrcnn_resnet50_fpn(pretrained=True),
    # 'maskrcnn_resnet50_fpn_v2': models.detection.maskrcnn_resnet50_fpn_v2(pretrained=True),
    # 'retinanet_resnet50_fpn': models.detection.retinanet_resnet50_fpn(pretrained=True),
    # 'retinanet_resnet50_fpn_v2': models.detection.retinanet_resnet50_fpn_v2(pretrained=True),
    # 'ssd300_vgg16': models.detection.ssd300_vgg16(pretrained=True),
    # 'ssdlite320_mobilenet_v3_large': models.detection.ssdlite320_mobilenet_v3_large(pretrained=True),
    # 'keypointrcnn_resnet50_fpn': models.detection.keypointrcnn_resnet50_fpn(pretrained=True),
    # 'r3d_18': models.video.r3d_18(pretrained=True),
    # 'mc3_18': models.video.mc3_18(pretrained=True),
    # 'r2plus1d_18': models.video.r2plus1d_18(pretrained=True),
    # 'mvit_v1_b': models.video.mvit_v1_b(),
    # 'raft_large': models.optical_flow.raft_large(pretrained=True),
    # 'raft_small': models.optical_flow.raft_small(pretrained=True),
    'fbnetc_100': geffnet.create_model('fbnetc_100', pretrained=True),
    'spnasnet_100': geffnet.create_model('spnasnet_100', pretrained=True),
    'efficientnet_b0_geffnet': geffnet.create_model('efficientnet_b0', pretrained=True),
    'efficientnet_b1_geffnet': geffnet.create_model('efficientnet_b1', pretrained=True),
    'efficientnet_b2_geffnet': geffnet.create_model('efficientnet_b2', pretrained=True),
    'efficientnet_b3_geffnet': geffnet.create_model('efficientnet_b3', pretrained=True),
    'efficientnet_b4_geffnet': geffnet.create_model('efficientnet_b4', pretrained=True),
    'efficientnet_b5_geffnet': geffnet.create_model('efficientnet_b5', pretrained=True),
    'efficientnet_b6_geffnet': geffnet.create_model('efficientnet_b6', pretrained=True),
    'efficientnet_b7_geffnet': geffnet.create_model('efficientnet_b7', pretrained=True),
    'qa+bert-base-cased': AutoModelForQuestionAnswering.from_pretrained('bert-base-cased'), 
    'qa+albert-base-v1': AutoModelForQuestionAnswering.from_pretrained('albert-base-v1'),
    'qa+roberta-base': AutoModelForQuestionAnswering.from_pretrained('roberta-base'),
    'qa+xlm-roberta-base': AutoModelForQuestionAnswering.from_pretrained('xlm-roberta-base'),
    'qa+google_electra-base-generator': AutoModelForQuestionAnswering.from_pretrained('google/electra-base-generator'),
    'qa+google_electra-base-discriminator': AutoModelForQuestionAnswering.from_pretrained('google/electra-base-discriminator'),
}


pretrained_models_str = {
    'alexnet': "models.alexnet(pretrained = True)",
    'convnext_tiny': "models.convnext_tiny(pretrained = True)",
    'convnext_small': "models.convnext_small(pretrained = True)",
    'convnext_base': "models.convnext_base(pretrained = True)",
    'convnext_large': "models.convnext_large(pretrained = True)",
    'swin_t': "models.swin_t()",
    'swin_s': "models.swin_s()",
    'swin_b': "models.swin_b()",
    'vit_b_16': "models.vit_b_16(pretrained = True)",
    'vit_b_32': "models.vit_b_32(pretrained = True)",
    'vit_l_16': "models.vit_l_16(pretrained = True)",
    'vit_l_32': "models.vit_l_32(pretrained = True)",
    'vit_h_14': "models.vit_h_14()",
    'vgg11': "models.vgg11(pretrained = True)",
    'vgg13': "models.vgg13(pretrained = True)",
    'vgg16': "models.vgg16(pretrained = True)",
    'vgg19': "models.vgg19(pretrained = True)",
    'vgg11_bn': "models.vgg11_bn(pretrained = True)",
    'vgg13_bn': "models.vgg13_bn(pretrained = True)",
    'vgg16_bn': "models.vgg16_bn(pretrained = True)",
    'vgg19_bn': "models.vgg19_bn(pretrained = True)",
    'resnet18': "models.resnet18(pretrained = True)",
    'resnet34': "models.resnet34(pretrained = True)",
    'resnet50': "models.resnet50(pretrained = True)",
    'resnet101': "models.resnet101(pretrained = True)",
    'resnet152': "models.resnet152(pretrained = True)",
    'resnext50_32x4d': "models.resnext50_32x4d(pretrained = True)",
    'resnext101_32x8d': "models.resnext101_32x8d(pretrained = True)",
    'resnext101_64x4d': "models.resnext101_64x4d()",
    'wide_resnet50_2': "models.wide_resnet50_2(pretrained = True)",
    'wide_resnet101_2': "models.wide_resnet101_2(pretrained = True)",
    'squeezenet1_0': "models.squeezenet1_0(pretrained = True)",
    'squeezenet1_1': "models.squeezenet1_1(pretrained = True)",
    'densenet121': "models.densenet121(pretrained = True)",
    'densenet169': "models.densenet169(pretrained = True)",
    'densenet201': "models.densenet201(pretrained = True)",
    'densenet161': "models.densenet161(pretrained = True)",
    'inception_v3_google': "models.inception_v3(pretrained = True)",
    'googlenet': "models.googlenet(pretrained = True)",
    'shufflenet_v2_x0_5': "models.shufflenet_v2_x0_5(pretrained = True)",
    'shufflenet_v2_x1_0': "models.shufflenet_v2_x1_0(pretrained = True)",
    'shufflenet_v2_x1_5': "models.shufflenet_v2_x1_5(pretrained = False)",
    'shufflenet_v2_x2_0': "models.shufflenet_v2_x2_0(pretrained = False)",
    'mobilenet_v2': "models.mobilenet_v2(pretrained = True)",
    'mobilenet_v3_large': "models.mobilenet_v3_large(pretrained = True)",
    'mobilenet_v3_small': "models.mobilenet_v3_small(pretrained = True)",
    'mnasnet0_5': "models.mnasnet0_5(pretrained = True)",
    'mnasnet0_75': "models.mnasnet0_75(pretrained = False)",
    'mnasnet1_0': "models.mnasnet1_0(pretrained = True)",
    'mnasnet1_3': "models.mnasnet1_3(pretrained = False)",
    'efficientnet_b0': "models.efficientnet_b0(pretrained = True)",
    'efficientnet_b1': "models.efficientnet_b1(pretrained = True)",
    'efficientnet_b2': "models.efficientnet_b2(pretrained = True)",
    'efficientnet_b3': "models.efficientnet_b3(pretrained = True)",
    'efficientnet_b4': "models.efficientnet_b4(pretrained = True)",
    'efficientnet_b5': "models.efficientnet_b5(pretrained = True)",
    'efficientnet_b6': "models.efficientnet_b6(pretrained = True)",
    'efficientnet_b7': "models.efficientnet_b7(pretrained = True)",
    'efficientnet_v2_s': "models.efficientnet_v2_s(pretrained = True)",
    'efficientnet_v2_m': "models.efficientnet_v2_m(pretrained = True)",
    'efficientnet_v2_l': "models.efficientnet_v2_l(pretrained = True)",
    'regnet_y_400mf': "models.regnet_y_400mf(pretrained = True)",
    'regnet_y_800mf': "models.regnet_y_800mf(pretrained = True)",
    'regnet_y_1_6gf': "models.regnet_y_1_6gf(pretrained = True)",
    'regnet_y_3_2gf': "models.regnet_y_3_2gf(pretrained = True)",
    'regnet_y_8gf': "models.regnet_y_8gf(pretrained = True)",
    'regnet_y_16gf': "models.regnet_y_16gf(pretrained = True)",
    'regnet_y_32gf': "models.regnet_y_32gf(pretrained = True)",
    'regnet_y_128gf': "models.regnet_y_128gf()",
    'regnet_x_400mf': "models.regnet_x_400mf(pretrained = True)",
    'regnet_x_800mf': "models.regnet_x_800mf(pretrained = True)",
    'regnet_x_1_6gf': "models.regnet_x_1_6gf(pretrained = True)",
    'regnet_x_3_2gf': "models.regnet_x_3_2gf(pretrained = True)",
    'regnet_x_8gf': "models.regnet_x_8gf(pretrained = True)",
    'regnet_x_16gf': "models.regnet_x_16gf(pretrained = True)",
    'regnet_x_32gf': "models.regnet_x_32gf(pretrained = True)",
    'fcn_resnet50': "models.segmentation.fcn_resnet50(pretrained = True)",
    'fcn_resnet101': "models.segmentation.fcn_resnet101(pretrained = True)",
    'deeplabv3_resnet50': "models.segmentation.deeplabv3_resnet50(pretrained = True)",
    'deeplabv3_resnet101': "models.segmentation.deeplabv3_resnet101(pretrained = True)",
    'deeplabv3_mobilenet_v3_large': "models.segmentation.deeplabv3_mobilenet_v3_large(pretrained = True)",
    'lraspp_mobilenet_v3_large': "models.segmentation.lraspp_mobilenet_v3_large(pretrained = True)",
    'fasterrcnn_resnet50_fpn': "models.detection.fasterrcnn_resnet50_fpn(pretrained=True)",
    'fasterrcnn_resnet50_fpn_v2': "models.detection.fasterrcnn_resnet50_fpn_v2(pretrained=True)",
    'fasterrcnn_mobilenet_v3_large_fpn': "models.detection.fasterrcnn_mobilenet_v3_large_fpn(pretrained=True)",
    'fasterrcnn_mobilenet_v3_large_320_fpn': "models.detection.fasterrcnn_mobilenet_v3_large_320_fpn(pretrained=True)",
    'fcos_resnet50_fpn': "models.detection.fcos_resnet50_fpn(pretrained=True)",
    'maskrcnn_resnet50_fpn': "models.detection.maskrcnn_resnet50_fpn(pretrained=True)",
    'maskrcnn_resnet50_fpn_v2': "models.detection.maskrcnn_resnet50_fpn_v2(pretrained=True)",
    'retinanet_resnet50_fpn': "models.detection.retinanet_resnet50_fpn(pretrained=True)",
    'retinanet_resnet50_fpn_v2': "models.detection.retinanet_resnet50_fpn_v2(pretrained=True)",
    'ssd300_vgg16': "models.detection.ssd300_vgg16(pretrained=True)",
    'ssdlite320_mobilenet_v3_large': "models.detection.ssdlite320_mobilenet_v3_large(pretrained=True)",
    'keypointrcnn_resnet50_fpn': "models.detection.keypointrcnn_resnet50_fpn(pretrained=True)",
    'r3d_18': "models.video.r3d_18(pretrained=True)",
    'mc3_18': "models.video.mc3_18(pretrained=True)",
    'r2plus1d_18': "models.video.r2plus1d_18(pretrained=True)",
    'mvit_v1_b': "models.video.mvit_v1_b()",
    'raft_large': "models.optical_flow.raft_large(pretrained=True)",
    'raft_small': "models.optical_flow.raft_small(pretrained=True)",
    'fbnetc_100': "geffnet.create_model('fbnetc_100', pretrained=True)",
    'spnasnet_100': "geffnet.create_model('spnasnet_100', pretrained=True)",
    'efficientnet_b0_geffnet': "geffnet.create_model('efficientnet_b0', pretrained=True)",
    'efficientnet_b1_geffnet': "geffnet.create_model('efficientnet_b1', pretrained=True)",
    'efficientnet_b2_geffnet': "geffnet.create_model('efficientnet_b2', pretrained=True)",
    'efficientnet_b3_geffnet': "geffnet.create_model('efficientnet_b3', pretrained=True)",
    'efficientnet_b4_geffnet': "geffnet.create_model('efficientnet_b4', pretrained=True)",
    'efficientnet_b5_geffnet': "geffnet.create_model('efficientnet_b5', pretrained=True)",
    'efficientnet_b6_geffnet': "geffnet.create_model('efficientnet_b6', pretrained=True)",
    'efficientnet_b7_geffnet': "geffnet.create_model('efficientnet_b7', pretrained=True)",
}